var idg=idg||{};idg.init=function(){var t=new idg.NavBtnPopup("logo",$("#js-openeyes-btn"),$("#js-openeyes-info")),e=new idg.NavBtnPopup("shortcuts",$("#js-nav-shortcuts-btn"),$("#js-nav-shortcuts-subnav")),i=new idg.NavBtnPopup("hotlist",$("#js-nav-hotlist-btn"),$("#js-hotlist-panel"));t.basic(),e.useWrapper($("#js-nav-shortcuts")),i.enhanced($("#js-hotlist-panel-wrapper")),idg.hotList(i),$(".hidden").removeClass("hidden").hide(),idg.patientPopups.init(),idg.collapseGroups(),idg.tooltips(),idg.overlayPopup(".js-demo-open-eyedraw-app","eyedraw-edit-app.php","#js-demo-eyedraw-app-close"),idg.overlayPopup(".js-demo-open-eyedraw-app-v2","eyedraw-edit-app-v2.php","#js-demo-eyedraw-app-close"),idg.overlayPopup(".js-demo-open-cataract","ed-opnote-cataract.php","#js-demo-eyedraw-app-close"),idg.overlayPopup("#js-change-context-btn","change-context.php",".close-icon-btn"),idg.overlayPopup("#copy-edit-history-btn","previous-history-elements.php",".close-icon-btn"),idg.overlayPopup("#copy-edit-anterior-segment-btn","previous-ed-anterior.php",".close-icon-btn"),idg.overlayPopup("#js-virtual-clinic-btn","virtual-clinic.php",".close-icon-btn"),idg.overlayPopup("#js-delete-event-btn","delete-event.php",".cancel-icon-btn"),idg.overlayPopup("#js-add-new-event","add-new-event.php",".close-icon-btn",function(t){t.find(".step-3").click(function(){window.location=$(this).data("url")})});idg.examElementSearchPopup(),idg.expandElementList(),idg.sidebar(),idg.sidebarQuickInfo(),idg.tileDataOverflow(),idg.collapseTiles(),idg.comments(),idg.elementAddSelectSearch(),idg.toggleRadio(),oes.oescapeExit(),idg.homeMessageExpand(),idg.auditTrail(),idg.vcDraggable(),idg.WorkListFilter(),idg.eventFilterActions(),idg.filterOptions(),idg.elementSubgroup()};var clinic=clinic||{};clinic.init=function(t){this.data=t,this.activePathwayID=0,this.activePathwayName="",$(".js-add-pathway").click(function(t){t.stopPropagation(),clinic.activePathwayID=$(this).data("id"),clinic.activePathwayName=$(this).data("name");var e=clinic.getPosition($(this));clinic.addPathway.show(e.left,e.top-15)}),$(".oe-clinic-list .pathway-step").each(function(){clinic.makeDefaultStep($(this));var t=$(this).attr("class").split(" ");void 0==$(this).data("data")?$(this).data("data",clinic.createDefaultData(t[1])):$(this).data("data").state=clinic.setState(t[1])}),$(".oe-clinic-filter").click(function(t){t.stopPropagation(),clinic.filterList($(this))}),this.setupDemoUI(),this.setupAddToAll(),this.setupAddPathway(),this.setupActiveInfo(),this.setupAssignments(),this.setupFilters(),this.setDurationGraphics(),this.showCurrentTime(),this.quicklook()},clinic.setupActiveInfo=function(){$("#js-active-step-info .close-icon-btn").click(function(t){t.stopPropagation(),clinic.activeInfo.hide()}),$("#js-activate-task").click(function(t){clinic.activeInfo.activate()}),$("#js-submit-pin-right").click(function(t){clinic.activeInfo.pin($("#js-user-pin-right").val(),"right")}),$("#js-submit-pin-left").click(function(t){clinic.activeInfo.pin($("#js-user-pin-left").val(),"left")}),$("#js-trash-active-step").click(function(t){clinic.activeInfo.removeStep()}),clinic.activeInfo={activeStep:null,removeStep:function(){this.activeStep.remove(),this.hide()},activate:function(){clinic.makeStepActive(this.activeStep),this.hide()},pin:function(t,e){"1234"===t?(clinic.stepComplete(this.activeStep),this.hide()):($(".eye-confirmation."+e).addClass("wrong-pin"),$("#js-user-pin-"+e).focus())},show:function(t,e,i){clinic.addPathway.hide(),$(".eye-confirmation").removeClass("wrong-pin"),this.activeStep=i;var n=i.data("data");$("#js-active-step-info .title").text(n.n),$("#js-active-step-info .eye .side").text(n.eye),$("#js-active-step-info .data").html(n.t),$("#js-active-step-info").removeClass("hidden").show().css({left:t,top:e}),$("#js-activate-task").hide(),$("#js-pin-confirmation").hide(),$("#js-who-completed").hide(),$("#js-trash-active-step").show();switch(n.state){case"ready":$("#js-activate-task").show();break;case"active":$("#js-pin-confirmation").show(),function(t){switch(t=t.toLowerCase()){case"right":$("#js-pin-confirmation .eye-confirmation.left").hide(),$("#js-pin-confirmation .eye-confirmation.right").show();break;case"left":$("#js-pin-confirmation .eye-confirmation.left").show(),$("#js-pin-confirmation .eye-confirmation.right").hide();break;default:$("#js-pin-confirmation .eye-confirmation.left").show(),$("#js-pin-confirmation .eye-confirmation.right").show()}}(n.eye);break;case"complete":$("#js-who-completed").show(),$("#js-trash-active-step").hide()}},hide:function(){this.activeStep=null,$(".input-confirmation").removeClass("wrong-pin"),$("#js-active-step-info").hide()}}},clinic.setupAddPathway=function(){$("#js-add-new-pathway .close-icon-btn").click(function(t){t.stopPropagation(),clinic.addPathway.hide()}),$("#js-add-new-pathway .next-step-add").click(function(t){t.stopPropagation(),clinic.addPathway.addStep($(this))}),$("#js-dilate-add-btn").click(function(e){e.stopPropagation(),function(){var e=clinic.addPathway.selectedStep,i={},n=!!clinic.addPathway.makeActive||clinic.isNewStepActive(),a=$("input[name=eye]:checked").val();i.eye=a;var s=$("input[name=fixed]:checked").val();if(void 0!==s){i.n="Fixed Dilate Set",i.t=s;e.clone();t(clinic.createNewStep(e,i,n)),t(clinic.createNewStep(e,i,n)),t(clinic.createNewStep(e,i,n)),clinic.addPathway.reset()}else{var o=$(".option-list input:checkbox:checked");if(o.length){i.n="Dilate",i.t="";for(var c=0;c<o.length;c++)i.t+=o[c].value+"<br>";t(clinic.createNewStep(e,i,n)),clinic.addPathway.reset()}}}()}),$("#js-pathway-back").click(function(t){t.preventDefault(),t.stopPropagation(),clinic.addPathway.back()}),$("#js-pathway-back").hide();function t(t){$("#patient-"+clinic.activePathwayID+" .pathway").append(t),clinic.updateTasks()}clinic.addPathway={selectedStep:null,makeActive:!1,show:function(t,e){clinic.activeInfo.hide(),$("#js-add-new-pathway").removeClass("hidden").show().css({left:t,top:e}),$("#js-add-new-pathway .title").text(clinic.activePathwayName)},addStep:function(e){if(this.makeActive=1==$(".make-active input:checkbox:checked").length,$(".make-active input").prop("checked",!1),"dilate"==e.data("id"))this.selectedStep=e,this.showDilateOptions();else{var i=!!this.makeActive||clinic.isNewStepActive(),n=clinic.createDefaultData("next-step");t(clinic.createNewStep(e,n,i)),this.selectedStep=null}},showDilateOptions:function(){$("#js-add-new-pathway .oec-new-pathway-steps").hide(),$("#add-dilate-options").removeClass("hidden").show(),$("#js-pathway-events-title span").hide(),$("#js-pathway-back").show()},back:function(){$("#js-add-new-pathway .oec-new-pathway-steps").show(),$("#add-dilate-options").hide(),$("#js-pathway-events-title span").show(),$("#js-pathway-back").hide()},reset:function(){$("#add-dilate-options .option-list input").prop("checked",!1),$("#add-dilate-options").hide(),$("#js-add-new-pathway .oec-new-pathway-steps").show(),$("#js-pathway-events-title span").show(),$("#js-pathway-back").hide()},hide:function(){this.reset(),$("#js-add-new-pathway").hide()}}},clinic.setupAddToAll=function(){$("#js-add-to-all-pathways .close-icon-btn").click(function(t){t.stopPropagation(),clinic.addToAll.hide()}),$("#js-add-to-all").on("click",function(t){t.stopPropagation(),clinic.addToAll.show()}),$("#js-add-all-set-btn").click(function(i){i.stopPropagation(),function(){var i=$("#js-add-to-all-pathways input[name=userset]:checked").val();if(void 0!==i&&1==i){var n=clinic.createPathwayStep("VA");clinic.makeDefaultStep(n),n.data("data",{eye:"left",n:"Visual Acuity",t:"In progress",state:"ready"});var a=clinic.createPathwayStep("Dilate");clinic.makeDefaultStep(a),a.data("data",{eye:"left",n:"Dilate",t:"Tropicamide",state:"ready"});var s=n.add(a);t(e,s)}}()}),$("#js-add-to-all-pathways .next-step-add").click(function(i){i.stopPropagation(),n=$(this),t(e,clinic.createNewStep(n,clinic.createDefaultData("next-step")));var n}),$("#js-add-to-all-pathways .select-deselect-all input").change(function(){$(".js-add-all-select").prop("checked",this.checked)});function t(t,e){$(".oe-clinic-list tbody tr").each(function(){var i=$(this).data("state");"active"!=i&&"inactive"!=i||t(this,e)})}function e(t,e){var i=$(".js-add-all-select",t).is(":checked"),n=$(t).is(":hidden");if(i&&!n){var a=$(".pathway-step",t).last().hasClass("green"),s=e.clone(!0);if(a){var o=s.first();clinic.makeDefaultStep(o),clinic.makeStepActive(o)}$(".pathway",t).append(s),clinic.updateTasks()}}function i(t){$(".js-add-pathway",t).hide(),$(".js-add-all-select",t).removeClass("hidden").prop("checked",!0).show()}function n(t){$(".js-add-pathway",t).show(),$(".js-add-all-select",t).hide()}clinic.addToAll={show:function(){clinic.addPathway.hide(),$("#js-add-to-all-pathways").removeClass("hidden").show(),$("#js-add-to-all-pathways .select-deselect-all input:checkbox").prop("checked",!0),t(i)},hide:function(){t(n),$("#js-add-to-all-pathways").hide()}}},clinic.changeAssignment=function(t,e,i){i=parseInt(i);var n=clinic.data[t].indexOf(i);n>-1&&clinic.data[t].splice(n,1),clinic.data[e].push(i),a(t),a(e);function a(t){$("#filter-"+t+" .current").text(clinic.data[t].length)}},clinic.createDefaultData=function(t){return{eye:"Both",n:"Not Set",t:"Currently no data is being generated for this step",state:clinic.setState(t)}},clinic.createNewStep=function(t,e,i){void 0===i&&(i=!1);var n=$.extend({},e),a=t.clone();return a.removeClass("next-step-add"),clinic.makeDefaultStep(a),a.data("data",n),i&&clinic.makeStepActive(a),a},clinic.createPathwayStep=function(t){var e=$("<span>",{class:"pathway-step"});return e.text(t),e.append('<span class="time"></span>'),e},clinic.filterList=function(t){var e=t.data("id");if($(".oe-clinic-filter").removeClass("selected"),$("#filter-"+e).addClass("selected"),"all"==e)$(".oe-clinic-list tbody tr").show();else{$(".oe-clinic-list tbody tr").hide();for(var i=clinic.data[e],n=0;n<i.length;n++)$("#patient-"+i[n]).show()}},clinic.getPosition=function(t){var e=t.position(),i=$(".oe-clinic-list").position();return e.top=e.top-i.top,e},clinic.isNewStepActive=function(){return!!$("#patient-"+clinic.activePathwayID+" .pathway-step").last().hasClass("green")},clinic.makeDefaultStep=function(t){t.addClass("next-step"),t.click(function(t){t.stopPropagation();var e=clinic.getPosition($(this));clinic.activeInfo.show(e.left,e.top,$(this))})},clinic.makeStepActive=function(t){t.data("data").state="active",t.removeClass("next-step").addClass("orange"),clinic.updateTasks()},clinic.makeStepComplete=function(t){t.data("data").state="complete",t.removeClass("orange").addClass("green"),t.children(".time").text("10:35"),clinic.updateTasks()},clinic.quicklook=function(){var t=$("#patient-clinic-quicklook");$(".js-clinic-quicklook").click(function(e){e.stopPropagation();var i=clinic.getPosition($(this));!function(e,i){offsetTop=i+30,t.find(".patient-details .name").text(e.data("name")),t.find(".patient-details .number").text(e.data("id")),e.find(".triangle").length?t.find(".alert-box").show():t.find(".alert-box").hide();t.removeClass("hidden").css({top:offsetTop}).show()}($(this),i.top)}),t.click(function(e){e.stopPropagation(),t.hide()})},clinic.setDurationGraphics=function(){$(".duration-mins").each(function(){var t=parseInt($(this).text());if(t>0){var e=$(this).parent().children(".duration-graphic");t>90?e.children(".c4").css({fill:"#f00"}):t>60?e.children(".c3").css({fill:"#f60"}):t>40?e.children(".c2").css({fill:"#ebcd00"}):e.children(".c1").css({fill:"#0c0"})}})},clinic.setState=function(t){var e;switch(t){case"next-step":e="ready";break;case"orange":e="active";break;case"green":case"blue":e="complete";break;case"dna":e="dna"}return e},clinic.setupAssignments=function(){$(".clinic-assign-options").each(function(){var t=$(this).val();$(this).data("previous",t)}),$(".clinic-assign-options").change(function(){var t=$(this).data("id");clinic.changeAssignment($(this).data("previous"),this.value,t),$(this).data("previous",this.value)})},clinic.setupDemoUI=function(){$(".pathway").each(function(){if($(this).children(".pathway-step").first().hasClass("dna")){var t=$(this).parents("tr");t.data("state","dna"),t.find(".clinic-assign-options").hide(),t.find(".js-add-pathway").hide(),t.find(".duration-graphic").css("opacity","0.3"),t.find(".duration-mins").hide()}});var t=$("#patient-1152572");t.data("state","complete");var e=t.find(".duration-graphic"),i=e.parent();e.hide(),i.addClass("complete"),i.children(".duration-mins").append(" mins"),t.find(".clinic-assign-options").hide(),t.find(".clinic-assign-options").parent().text("Dr Amit Baum (AB)"),t.find(".js-add-pathway").hide(),$("#filter-AB .total").text(1)},clinic.setupFilters=function(){$("#filter-all").addClass("selected");for(obj in clinic.data){var t=clinic.data[obj],e=obj.toString();if($("#filter-"+e+" .current").text(t.length),"dna"!=obj&&"tasks"!=obj)for(var i=0;i<t.length;i++)$("#patient-"+t[i]+" .clinic-assign-options").val(e)}$(".clinic-assign-options").each(function(){if("unassigned"==$(this).val()&&$(this).is(":visible")){var t=$(this).parents("tr").data("id");clinic.data.unassigned.push(parseInt(t))}}),$("#filter-unassigned .current").text(clinic.data.unassigned.length)},clinic.showCurrentTime=function(){var t=!1;$(".oe-clinic-list tbody tr").each(function(){var e=$(this).find("td").first();if("10:35"==e.text()){t=!0;var i=clinic.getPosition(e);$(".clinic-time").css({top:i.top-7})}t&&$(this).addClass("future")})},clinic.stepComplete=function(t){clinic.makeStepComplete(t);var e=t.next();e.length&&e.hasClass("next-step")&&clinic.makeStepActive(e)},clinic.updateTasks=function(){$("#js-clinic-list-patients tr").each(function(){if("active"==$(this).data("state")){var t=parseInt($(this).data("id")),e=clinic.data.tasks.indexOf(t);$(".pathway-step.orange",this).length?-1==e&&clinic.data.tasks.push(t):e>-1&&clinic.data.tasks.splice(e,1)}}),$("#filter-tasks .current").text(clinic.data.tasks.length)},idg.homeMessageExpand=function(){0!=$(".home-messages").length&&$(".js-expand-message").each(function(){var t=$(this).parent().parent().find(".message");new function(t,e){var i=!1;t.click(function(){t.toggleClass("expand collapse"),i?e.removeClass("expand"):e.addClass("expand");i=!i})}($(this),t)})};var oes={init:function(){$("#js-exit-oescape").click(function(){window.location=localStorage.getItem("lastPage")})},oescapeExit:function(){var t=window.location.href;0==t.includes("oescape")&&localStorage.setItem("lastPage",t)}};oes.initStack=function(t,e,i){var n=1,a=(t=$(t)).children().length;$(t).bind("mousemove touchmove",function(t){t.stopPropagation();var e=$(this).offset(),n=t.pageX-e.left,o=$(this).width(),c=Math.ceil(n/(o/a));0===c||c>a||(s(c),"function"==typeof i&&i(c))});function s(t){$(e+n).hide(),$(e+t).removeClass("hidden").show(),n=t}return{setImg:function(t){s(t),t=t}}},oes.setupAreaTabButtons=function(t,e){for(var i=0;i<t.length;i++)new n(t[i].btn=$(t[i].btn),t[i].content=$(t[i].content),i);t[0].btn.addClass("selected");function n(i,n,a){n=n,a=a;(i=i).click(function(i){i.stopPropagation(),function(){for(var e=0;e<t.length;e++)t[e].btn.removeClass("selected"),t[e].content.hide()}(),$(this).addClass("selected"),n.removeClass("hidden").show(),"function"==typeof e&&e(a)})}},oes.setupResizeButtons=function(t){var e,i=$(".oes-left-side"),n=$(".oes-right-side");$(".js-oes-area-resize").click(function(a){a.stopPropagation();switch($(this).data("area")){case"small":e=500;break;case"medium":e=700;break;case"large":e=900;break;case"full":e=null}null==e?(i.css({"min-width":"500px",width:"100%"}),n.hide()):(i.css({"min-width":e+"px",width:""}),n.show()),"function"==typeof t&&t(e)})},idg.lightningViewer=function(){"/v3.0/lightning-letter-viewer"!=window.location.pathname?$("#js-lightning-viewer-btn").click(function(t){t.stopPropagation(),window.location="/v3.0/lightning-letter-viewer"}).mouseenter(function(){$(this).addClass("active")}).mouseleave(function(){$(this).removeClass("active")}):$("#js-lightning-viewer-btn").addClass("active")},idg.patientPopups={init:function(){if(0!=$("#oe-patient-details").length){var t=[new idg.PatientBtnPopup("quicklook",$("#js-quicklook-btn"),$("#patient-summary-quicklook")),new idg.PatientBtnPopup("demographics",$("#js-demographics-btn"),$("#patient-popup-demographics")),new idg.PatientBtnPopup("management",$("#js-management-btn"),$("#patient-popup-management")),new idg.PatientBtnPopup("risks",$("#js-allergies-risks-btn"),$("#patient-popup-allergies-risks"))];for(pBtns in t)t[pBtns].inGroup(this);this.popupBtns=t,$("#problems-plans-sortable").length&&idg.problemsPlans()}},closeAll:function(){for(pBtns in this.popupBtns)this.popupBtns[pBtns].hide()}},idg.problemsPlans=function(){var t=document.getElementById("problems-plans-sortable");Sortable.create(t);$("#js-add-pp-btn").click(function(){var t=$("#create-problem-plan"),e=t.val();if(""!==e){var i='<li><span class="drag-handle">&#9776;</span>'+e+'<div class="remove"><i class="oe-i remove-circle small pro-theme pad"></i></div></li>';$("#problems-plans-sortable").append(i),t.val("")}}),$("#problems-plans-sortable .remove").click(function(){$(this).parent().remove()})},idg.auditTrail=function(){if(0!=$("#js-event-audit-trail-btn").length){$("#js-event-audit-trail-btn").click(function(){$("#js-event-audit-trail").toggle(),$(this).toggleClass("active")})}},idg.elementAddSelectSearch=function(){var t=[];$(".js-add-select-search").each(function(){var e=new function(e,i){var n=i.find(".search-options"),a=i.find(".select-options"),s=i.find(".close-icon-btn"),o=i.find(".select-icon-btn"),c=i.find(".search-icon-btn"),l=i.find(".add-icon-btn"),d=i.find(".js-search-autocomplete"),p=!0;switch(i.prop("id")){case"add-to-history":case"add-to-risks":case"add-to-follow-up":p=!1}var r=[];this.closePopup=h,s.click(function(t){t.stopPropagation(),h()}),o.click(function(t){t.stopPropagation(),f(),c.length&&v()}),l.length&&l.click(function(t){t.stopPropagation(),u()});c.length&&c.click(function(t){t.stopPropagation(),function(){a.hide(),n.show(),d.focus();var t=$(".js-search-results").hide();d.keypress(function(){"au"===d.val()&&t.show()})}(),v()});$(".add-options",i).each(function(){$(this).data("multi");r.push(new function(t,e,i){var e=e,n=null,a=[];(i=i)&&l.hide();e?$("li",t).click(function(t){t.stopPropagation(),$(this).toggleClass("selected"),$(this).hasClass("selected")?s($(this).data("str")):o($(this).data("str"))}):$("li",t).click(function(t){t.stopPropagation(),function(t){null!=n&&(n.removeClass("selected"),o(n.data("str")));t.addClass("selected"),s(t.data("str")),n=t}($(this)),i&&u()});function s(t){a.push(t)}function o(t){var e=a.indexOf(t);-1!==e&&a.splice(e,1)}this.getData=function(t){return a.join(t)},this.clearData=function(){a=[]}}($(this),$(this).data("multi"),$(this).data("clickadd")))});e.click(function(n){n.stopPropagation(),function(){for(var e=0;e<t.length;e++)t[e].closePopup()}(),f(),function(t){var e=t[0].getBoundingClientRect(),n=document.documentElement.clientWidth,a=document.documentElement.clientHeight;i.css({bottom:a-e.bottom,right:n-e.right});var s=$(".main-event").scrollTop();$(".main-event").on("scroll",function(){s!=$(this).scrollTop()&&($(".main-event").off("scroll"),h())})}(e),i.show(),o.children(".oe-i").addClass("selected"),c.children(".oe-i").removeClass("selected")});function h(){if(n.hide(),d.val(""),i.hide(),p){i.find(".add-options li").removeClass("selected");for(var t=0;t<r.length;t++)r[t].clearData()}}function u(){if("add-to-refraction"==i.prop("id")){var t="",e="",n="";type="";for(var a=0;a<r.length;a++){var s=r[a].getData("");switch(a){case 0:case 1:case 2:t+=s;break;case 3:case 4:case 5:e+=s;break;case 6:n=s;break;case 7:type=s}}$("#js-refraction-input-sphere").val(t),$("#js-refraction-input-cylinder").val(e),$("#js-refraction-input-axis").val(n),$("#js-refraction-input-type").val(type)}"add-to-pupils-left"==i.prop("id")&&$("#js-pupil-left-text").text(r[0].getData("")),"add-to-pupils-right"==i.prop("id")&&$("#js-pupil-right-text").text(r[0].getData("")),"add-to-analytics-service"==i.prop("id")&&$("#js-service-selected").text(r[0].getData("")),"add-to-history"==i.prop("id")&&o("history"),"add-to-risks"==i.prop("id")&&o("risks"),"add-to-follow-up"==i.prop("id")&&o("follow-up");function o(t){for(var t="#js-"+t+"-input-demo",e=[],i=0;i<r.length;i++){var n=r[i].getData(", ");""!=n&&e.push(n)}$(t).val(e.join(", ")),autosize.update($(t))}if("add-to-procedures"==i.prop("id"))for(var c=$("#js-procedures-template"),l=r[0].getData(","),d=l.split(","),a=0;a<d.length;a++){var p=c.clone();p.removeAttr("style id"),p.find(".js-procedure-name").text(d[a]),$("#js-show-procedures").append(p),"Phacoemulsification and IOL"==d[a]&&($(".edit-phaco--iol-right").show(),$(".edit-pcr-risk-right").show(),p.find(".js-add-comments").hide())}h()}function f(){a.show(),n.hide(),d.val("")}function v(){o.children(".oe-i").toggleClass("selected"),c.children(".oe-i").toggleClass("selected")}}($(this),$(this).parent().children(".oe-add-select-search"));t.push(e)})},idg.elementSubgroup=function(){0!=$(".js-element-subgroup-viewstate-btn").length&&$(".js-element-subgroup-viewstate-btn").each(function(){new function(t){var e=this,i=$("#"+t.data("subgroup"));t.click(function(t){t.preventDefault(),e.changeState()}),this.changeState=function(){i.toggle(),t.toggleClass("collapse expand")}}($(this))})},idg.eventFilterActions=function(){0!=$("#js-sidebar-filter-btn").length&&idg.enhancedTouch($("#js-sidebar-filter"),$("#js-sidebar-filter-btn"),$("#js-sidebar-filter-options"))},idg.examElementSearchPopup=function(){null!==document.getElementById("js-search-in-event-popup")&&$("#js-search-in-event").click(function(){$("#js-search-in-event-popup").show(),$(".close-icon-btn").click(function(){$("#js-search-in-event-popup").hide(),$("#js-search-in-event").removeClass("selected"),$("#js-search-event-input-right").val(""),$("#js-search-event-results").hide()}),$("#js-search-event-input-right").keyup(function(){var t=$(this).val().toLowerCase();"alph"==t||"alpha"==$(this).val()?$("#js-search-event-results").show():$("#js-search-event-results").hide()}),$(this).addClass("selected")})},idg.expandElementList=function(){0!=$(".element-data").length&&$(".js-listview-expand-btn").each(function(){var t=$(this).data("list"),e=$(this).data("list2");new function(t,e,i){var n=!0,a=new c(e),s=void 0!=i&&new c(i);t.click(function(){$(this).toggleClass("collapse expand"),o(n=!n,a),0!=s&&o(n,s)});function o(t,e){t?(e.$pro.show(),e.$full.hide()):(e.$pro.hide(),e.$full.show())}function c(t){this.$pro=$("#js-listview-"+t+"-pro"),this.$full=$("#js-listview-"+t+"-full")}}($(this),t,e)})},idg.sidebar=function(){if(null!=document.getElementById("js-sidebar-filter")){(function(t){$("li",t).each(function(){$(this).data("UTC",Date.parse($(this).data("created-date")))})})("#js-events-by-date")}},idg.sidebarQuickInfo=function(){if(0!=$(".events").length){$(".events .event").each(function(){new function(i,n){i.hover(function(){n.removeClass("hidden").show(),i=$(this).data("id"),a=$(this).data("date"),e.stop().fadeIn(50),$("#quickview-"+t).hide(),$("#quickview-"+i).show(),$("#js-quickview-date").text(a),t=i;var i,a},function(){n.hide(),e.stop().fadeOut(150)})}($(".event-type",this),$(".quicklook",this))}),$("[id^=quickview]").hide();var t=null,e=$("#js-event-quickview")}},idg.collapseTiles=function(){$(".js-tiles-collapse-btn").each(function(){var t=$(this).data("group"),e=$("#"+t),i=e.data("collapse");new function(t,e,i){var n=e.children(".tile"),a="expanded"==i;t.click(function(){!function(){if(a){n.find(".element-data").hide(),n.find(".tile-more-data-flag").hide();$('<i class="oe-i expand small pad-right js-data-collapsed-icon"></i>');var e=$('<span class="js-data-hidden-state"> [0]</span>');n.find(".element-title").append(e)}else n.find(".js-data-hidden-state").remove(),n.find(".element-data").show(),n.find(".tile-more-data-flag").show();t.toggleClass("expand collapse"),a=!a}()})}($(this),e,i)})},idg.tileDataOverflow=function(){0!=$(".element.tile").length&&$(".element.tile").each(function(){if($(this).find(".data-value").height()>179){var t=$("<div/>",{class:"tile-more-data-flag"}),e=$("<i/>",{class:"oe-i arrow-down-bold medium selected"});t.append(e),$(this).prepend(t);var i=$(".tile-data-overflow",this);t.click(function(){i.animate({scrollTop:i.height()},1e3)}),i.on("scroll",function(){t.fadeOut()});var n=$(this).find("tbody").get(0).childElementCount,a=$(".element-title",this);a.html(a.text()+" <small>("+n+")</small>")}})},idg.NavBtnPopup=function(t,e,i){var n=e,a=!1,s=!1,o=!0,c=!1,l=!1,d={active:"active",open:"open",locked:"open"};this.hide=f,this.show=u,this.fixed=function(t){c=t,t?(i.off("mouseenter mouseleave"),e.addClass(d.locked),u()):(l=!1,e.removeClass(d.locked),f())},this.basic=function(){p(),r()},this.useWrapper=function(t){n=t,d.open=d.active,o=!1,p(),r(),n.mouseenter(function(){u()}).mouseleave(function(){f()})},this.enhanced=function(t){n=t,d.open=d.active,o=!1,p(),e.click(function(t){t.stopPropagation(),s&&0==c?l?(l=!1,e.removeClass(d.locked),f()):(l=!0,e.addClass(d.locked)):h()}),n.mouseenter(function(){s=!0,u()}).mouseleave(function(){0==l&&0==c&&f()})};function p(){n.mouseenter(function(){e.addClass(d.active)}).mouseleave(function(){e.removeClass(d.active)})}function r(){n.click(function(t){t.stopPropagation(),h()})}function h(t){c||l||(a?f():u())}function u(){e.addClass(d.open),i.show(),o&&i.mouseenter(function(){$(this).off("mouseenter"),$(this).mouseleave(function(){$(this).off("mouseleave"),f()})}),a=!0}function f(){e.removeClass(d.open),i.hide(),a=!1,s=!1}},idg.PatientBtnPopup=function(t,e,i){var n=!1,a=!1,s=!1,o=!1,c=null,l={active:"active",open:"open"};this.inGroup=function(t){o=!0,c=t},this.hide=function(){p(),a=!1,s=!1},this.show=d,e.click(function(t){t.stopPropagation(),n?s?(a=!0,s=!1):p():d()}).mouseenter(function(){0==a&&(d(),s=!0)}).mouseleave(function(){0==a&&(p(),s=!1)});function d(){o&&c.closeAll(),i.show(),n=!0,e.addClass(l.open)}function p(){i.hide(),n=!1,e.removeClass(l.open)}},idg.collapseGroups=function(){$(".collapse-group").each(function(){new function(t,e,i,n){var a=t,s=e,o=i,c="expanded"==n;0==c&&o.removeClass("hidden").hide();a.click(function(){l()}),s.click(function(){l()});function l(){c?o.hide():o.show(),a.toggleClass("minus plus"),c=!c}}($(this).find(".collapse-group-icon .oe-i"),$(this).find(".collapse-group-header"),$(this).find(".collapse-group-content"),$(this).data("collapse"))})},idg.comments=function(){$(".js-add-comments").click(function(t){t.stopPropagation();var e=$(this),i=$("#"+e.data("input"));e.hide(),i.show(0,function(){var t=$(this).find("textarea"),n=$(this).find(".js-remove-add-comments");t.focus(),n.click(function(){i.hide(),e.show()})})})},idg.enhancedPopupFixed=function(t,e,i){var n,a=!1;e.click(function(){a?o():s()}),t.mouseenter(s).mouseleave(o);function s(){!function(){var e=t.offset(),a=window.innerWidth,s=window.innerHeight;n=e.top<s/2?"top-":"bottom-";e.left<a/2?n+="left":n+="right";i.addClass(n)}(),function(){var e=t[0].getBoundingClientRect(),a=document.documentElement.clientWidth,s=document.documentElement.clientHeight;switch(n){case"top-left":i.css({top:e.y,left:e.x});break;case"top-right":i.css({top:e.y,right:a-e.right});break;case"bottom-left":i.css({bottom:s-e.bottom,left:e.x});break;case"bottom-right":i.css({bottom:s-e.bottom,right:a-e.right})}}(),i.show(),e.addClass("active"),a=!0}function o(){i.hide(),e.removeClass("active"),a=!1,i.removeClass(n),i.css("top",""),i.css("bottom",""),i.css("left",""),i.css("right","")}i.find(".close-icon-btn").click(o)},idg.enhancedTouch=function(t,e,i,n){var a=!1;e.click(function(){a?o():s()}),t.mouseenter(s).mouseleave(o);function s(){i.show(),e.addClass("active"),a=!0}function o(){i.hide(),e.removeClass("active"),a=!1}i.find(".close-icon-btn").click(o)},idg.filterOptions=function(){0!=$(".oe-filter-options").length&&$(".oe-filter-options").each(function(){var t=$(this).data("filter-id");idg.enhancedPopupFixed($("#oe-filter-options-"+t),$("#oe-filter-btn-"+t),$("#filter-options-popup-"+t));$("#filter-options-popup-"+t).find(".options-group").each(function(){!function(t){var e=t.data("filter-ui-id"),i=$(".btn-list li",t);i.click(function(){$("#"+e).text($(this).text()),i.removeClass("selected"),$(this).addClass("selected")})}($(this))})})},idg.hotList=function(t){if(0!=$("#js-nav-hotlist-btn").length){if(1==$("#js-nav-hotlist-btn").data("fixable")){e(),$(window).resize(function(){e()});function e(){$(window).width()>1890?t.fixed(!0):t.fixed(!1)}}if(1!=$("#js-hotlist-panel").data("vc")){$(".oe-hotlist-panel .js-patient-comments").click(function(t){var e=$(this).parent().parent().next(),i=e.find("textarea");a(!1),e.toggle(),""==i.val()?$(this).hasClass("comments-added")&&($(this).removeClass("comments-added active"),$(this).addClass("comments")):$(this).hasClass("comments")&&($(this).removeClass("comments"),$(this).addClass("comments-added active"))}),$(".oe-hotlist-panel .js-patient-comments").mouseenter(function(){a(!0,$(this))}).mouseleave(function(){a(!1)});var i=$("#js-pickmeup-datepicker").hide(),n=pickmeup("#js-pickmeup-datepicker",{format:"a d b Y",flat:!0,position:"left"});document.getElementById("js-pickmeup-datepicker").addEventListener("pickmeup-change",function(t){$("#js-pickmeup-closed-date").text(t.detail.formatted_date),i.hide()}),$("#js-hotlist-closed-select").click(function(){i.show()}),$("#js-hotlist-closed-today").click(function(){n.set_date(new Date),$("#js-pickmeup-closed-date").text("Today")})}}function a(t,e){if($quick=$("#hotlist-quicklook"),t){var i=e.parent().parent().next().find("textarea");""!=i.val()&&($quick.text(i.val()),$quick.show(),$quick.css("top",e.position().top+19))}else $quick.hide()}},idg.overlayPopup=function(t,e,i,n){return $(t).length&&$(t).click(function(t){t.stopPropagation(),a()}),this.test=a,this;function a(){var t=$("<div>");t.addClass("oe-popup-wrap"),t.load("/php/v3.0/_load/"+e,function(){e=$(i,this),a=$(this),e.click(function(){a.remove()});var e,a;n&&n(t)}),$("body").prepend(t)}},idg.toggleRadio=function(){$(".js-toggle-radio-checked").each(function(){var t=!0;$(this).click(function(){$(this).prop("checked",t),t=!t})})},idg.tooltips=function(){$(".js-has-tooltip").hover(function(){var t,e,i=$(this).data("tooltip-content"),n=$(this).offset();$(window).width()-n.left<100?(t=n.left-174,e="oe-tooltip offset-left"):(t=n.left-94,e="oe-tooltip");var a=$("<div></div>",{class:e,style:"position:fixed; left:"+t+"px; top:0;"});a.text(i),$("body").append(a);var s=$(".oe-tooltip").height(),o=n.top-s-20;$(".oe-tooltip").css({top:o+"px"})},function(){$(".oe-tooltip").remove()})},idg.vcDraggable=function(){var t="oe-vc-scratchpad";if(0!=$("#"+t).length){var e,i;document.addEventListener("dragstart",a,!1),document.addEventListener("dragend",s,!1);var n=document.getElementById(t);n.addEventListener("touchstart",a,!1),n.addEventListener("touchend",s,!1)}function a(n){n.dataTransfer.dropEffect="move";var a=$("#"+t).offset();e=n.clientX-a.left,i=n.clientY-a.top}function s(n){var a=n.clientX-e,s=n.clientY-i;s=s<1?1:s,a=a<1?1:a,$("#"+t).css({top:s+"px",left:a+"px"})}},idg.WorkListFilter=function(){0!=$(".js-worklist-filter").length&&($(".js-worklist-filter").each(function(){$(this).click(function(t){t.preventDefault(),$(".js-worklist-filter").removeClass("selected"),$(this).addClass("selected"),"all"==(e=$(this).data("worklist"))?$(".worklist-group").show():($(".worklist-group").hide(),$("#"+e).show());var e})}),$(".clickable-rows tbody tr").click(function(){window.location="/v3.0-SEM/_overview"}))};